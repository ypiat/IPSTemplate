@namespace IPSTemplate.UI.Blazor.Features.Book

@using Core.Library.Base
@using Csla.Core
@using IPSTemplate.BusinessLibrary.BO.Book
@using IPSTemplate.BusinessLibrary.BO.BookCopy;
@using IPSTemplate.UI.Blazor.Features.BookCopy
@using Telerik.Blazor
@using Telerik.Blazor.Components
@using IPSTemplate.Dal.Models
@using Telerik.DataSource



@inherits GridView<BooksGrid,
                   TEBookInfo,
                   TEBookGridInfo,
                   TEBookRL,
                   TEBook>




    <IPSGrid Id="BooksGrid" ShowHeader=true
             OnRead=ReadData TItem=TEBookInfo
             Context="book" EnableLoaderContainer=true>
        <GridColumns>
            <IPSGridColumn Id="Id" Field=@nameof(TEBookInfo.Id) Visible=false />
            <IPSGridColumn  Id="Name" Field=@nameof(TEBookInfo.Name) />
            <IPSGridColumn  Id="Author" Title="Avtor/je" Field=@nameof(TEBookInfo.AuthorNames)>
                @*<FilterCellTemplate>

            </FilterCellTemplate>*@
            </IPSGridColumn>
            <IPSGridColumn  Id="Genre" Field=@nameof(TEBookInfo.GenreName)>
            <Template>
                @{
                    var book = (TEBookInfo)context;
                    var color = GetColor(book);
                    <IPSBadge Color="color">@book.GenreName</IPSBadge>
                }
            </Template>
            </IPSGridColumn>
            <IPSGridColumn  Id="Language" Field=@nameof(TEBookInfo.Language) />
            <IPSGridColumn  Id="PageAmount" Field=@nameof(TEBookInfo.PageAmount) />
            <IPSGridColumn  Id="CopyAmount" Title="Število kopij"/>        
            <IPSGridCommandColumn >
                <IPSButton OnClick=@(() => EditClicked.InvokeAsync((TEBookInfo)context)) Icon=Icon.Pencil />
                <IPSButton OnClick=@(() => AddClicked.InvokeAsync((TEBookInfo)context)) Icon=Icon.Add />
            </IPSGridCommandColumn>
        </GridColumns>

    <DetailTemplate>
            <IPSGrid Data=book.BookCopies FilterMode="GridFilterMode.None">
                <GridColumns>
                    <IPSGridColumn Field=@nameof(TEBookCopyInfo.Id) Visible=false  />
                    <IPSGridColumn Field=@nameof(TEBookCopyInfo.BookName) Title="Naslov"  />
                    <IPSGridColumn Field=@nameof(TEBookCopyInfo.PublishedYear) Title="Leto izdaje"  />
                    <IPSGridColumn Field=@nameof(TEBookCopyInfo.PublisherName) Title="Založba"  />
                    <IPSGridColumn Field=@nameof(TEBookCopyInfo.Status) Title="Stanje"  />
                    <IPSGridCommandColumn>
                    <IPSButton OnClick=@(() => CopyEditClicked.InvokeAsync((TEBookCopyInfo)context)) Icon=Icon.Pencil />
                    </IPSGridCommandColumn>
                </GridColumns>
            </IPSGrid>
    </DetailTemplate>
    </IPSGrid>




